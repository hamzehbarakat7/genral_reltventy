<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ø²Ù…ÙƒØ§Ù† 3D â€” Ù†Ø³Ø®Ø© Ø£Ø¯Ù‚</title>
<style>
  :root{ --bg:#0b0f16; --panel:#0f1624; --accent:#59c1ff; --muted:#9fb3c8; --good:#7ee787; --warn:#ffd166; --bad:#ff6b6b; --grid:#1f2a3d; --text:#e6edf3; --header:#0c1420; }
:root.light{ --bg:#f7f9fc; --panel:#ffffff; --accent:#0066ff; --muted:#5a6b7e; --good:#1f8f3a; --warn:#a36b00; --bad:#c03d3d; --grid:#e6eef6; --text:#0f172a; --header:#ffffff; }
*{box-sizing:border-box}
html,body{height:100%;margin:0;overflow:hidden}
body{background:var(--bg);color:var(--text);font:14px/1.5 system-ui,Segoe UI,Roboto,Arial}
header{display:flex;align-items:center;gap:12px;padding:10px 14px;background:var(--header);border-bottom:1px solid #152033;z-index:5}
header h1{font-size:16px;margin:0;color:#cfe3ff}
:root.light header h1{color:#003366}
header .badge{padding:3px 8px;border:1px solid #22324a;border-radius:9999px;color:#c2d4ee;font-size:12px}
header .legend{margin-inline-start:auto;display:flex;gap:8px;flex-wrap:wrap}
.wrap{display:flex;flex-direction:column;height:calc(100vh - 44px)}
.main-content{flex:1;position:relative;overflow:hidden;background:radial-gradient(1400px 900px at 50% 40%, #0f1a2a 0, var(--bg) 70%)}
:root.light .main-content{background:radial-gradient(1400px 900px at 50% 40%, #e6f0ff 0, var(--bg) 70%)}
aside{background:var(--panel);border-top:1px solid #152033;padding:12px;display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:10px;max-height:35vh;overflow-y:auto}
.group{border:1px solid #1f2a3d;border-radius:10px;padding:10px;background:color-mix(in srgb, var(--panel) 94%, #000 6%)}
.group h3{margin:0 0 8px 0;font-size:13px;color:#cfe3ff}
:root.light .group h3{color:#003366}
.group h4{margin:0 0 6px 0;font-size:12px;color:#b9d3ff}
label{display:grid;grid-template-columns: 1fr auto; gap:6px; align-items:center;margin:5px 0;font-size:12px}
input[type="number"], input[type="text"], select{width:140px;background:#0c1320;color:#e6edf3;border:1px solid #1f2a3d;border-radius:6px;padding:5px;font-size:12px}
:root.light input[type="number"], :root.light input[type="text"], :root.light select{background:#f1f5fb;color:#0f172a;border-color:#cbd5e1}
input[type="checkbox"]{transform:scale(1.1)}
input[type="range"]{width:100%}
button{background:#122035;border:1px solid #283a57;color:#e6f2ff;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:12px}
button:hover{border-color:#3c577f;background:#1a2a45}
:root.light button{background:#e6f0ff;border-color:#bfd4ff;color:#003366}
.row{display:flex;gap:8px;flex-wrap:wrap} .row > *{flex:1}
.pill{padding:4px 8px;border-radius:9999px;border:1px solid #22324a;color:#c9ddff;font-size:11px}
#view{display:block;width:100%;height:100%}
.hud{position:absolute;left:10px;top:10px;background:rgba(15,22,36,.85);border:1px solid #1f2a3d;border-radius:10px;padding:10px;backdrop-filter:blur(6px);min-width:260px;max-width:320px}
:root.light .hud{background:rgba(255,255,255,.85);border-color:#cbd5e1}
.grid{display:grid;grid-template-columns:auto 1fr;gap:4px 10px;align-items:center;font-size:11px}
.cards{display:grid;gap:8px;grid-template-columns:repeat(auto-fit,minmax(180px,1fr))}
.card{background:#0e1626;border:1px solid #1f2a3d;border-radius:8px;padding:8px;font-size:11px}
:root.light .card{background:#ffffff;border-color:#e2e8f0}
.card h4{margin:0 0 6px 0;font-size:12px;color:#cfe3ff;display:flex;justify-content:space-between;align-items:center}
:root.light .card h4{color:#003366}
.card .meta{display:grid;grid-template-columns:auto 1fr;gap:3px 8px;color:#9fb3c8}
:root.light .card .meta{color:#334155}
.card .rowBtns{display:flex;gap:4px;margin-top:6px}
.card button{padding:4px 8px;font-size:10px}
.badgeSmall{padding:2px 5px;border:1px solid #28405e;border-radius:999px;color:#9fd1ff;font-size:10px}
.selected{outline:2px solid var(--accent)}
#chart{display:block;margin-top:8px;width:100%;height:90px}
.toggleTheme{margin-inline-start:8px}

</style>
</head>
<body>
<header>
  <h1>Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ø²Ù…ÙƒØ§Ù† 3D</h1>
  <span class="badge">RK4 ØªÙƒÙŠÙÙŠ + 1PN (Ù†Ø³Ø¨ÙŠ) + 3D</span>
  <div class="legend">
    <span class="pill">Ø¥Ø³Ù‚Ø§Ø· 3D</span>
    <span class="pill">Ù…Ø³Ø§Ø±Ø§Øª</span>
  </div>
  <button id="btnTheme" class="toggleTheme">ğŸŒ™ Night / â˜€ï¸ Day</button>
</header>

<div class="wrap">
  <div class="main-content">
    <canvas id="view"></canvas>
    <div class="hud">
      <h4>Ù„ÙˆØ­Ø© ÙÙŠØ²ÙŠØ§Ø¦ÙŠØ©</h4>
      <div class="grid" id="stats"></div>
      <canvas id="chart"></canvas>
    </div>
  </div>

  <aside>
    <div class="group">
      <h3>Ø§Ù„ØªØ­ÙƒÙ…</h3>
      <div class="row">
        <button id="btnPlay">â–¶ ØªØ´ØºÙŠÙ„</button>
        <button id="btnStep">â­ Ø®Ø·ÙˆØ©</button>
        <button id="btnReset">âŸ² Ø¥Ø¹Ø§Ø¯Ø©</button>
      </div>
      <label>Ø§Ù„Ø³Ø±Ø¹Ø© <input type="number" id="speedMul" step="0.5" value="1" style="width:80px" /></label>
      <label>Î”t (Ø«) <input type="number" id="dt" step="0.1" value="1" style="width:80px" /></label>
      <label><input type="checkbox" id="adaptive" checked /> ØªÙƒÙŠÙÙŠ</label>
      <label><input type="checkbox" id="enablePN" /> 1PN</label>
      <!-- Ø¨Ø¹Ø¯ Ø³Ø·Ø± <label><input type="checkbox" id="enablePN" /> 1PN</label> -->
    <label><input type="checkbox" id="enablePN2" /> 2PN (Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©)</label>
    <label><input type="checkbox" id="tidalForces" /> Ù‚ÙˆÙ‰ Ø§Ù„Ù…Ø¯ ÙˆØ§Ù„Ø¬Ø²Ø±</label>
    <label><input type="checkbox" id="gravWaves" /> Ù…ÙˆØ¬Ø§Øª Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©</label>

<!-- ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØµÙ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
<button id="btnAnalyze">ğŸ“Š ØªØ­Ù„ÙŠÙ„</button>
      <label>Ø§Ù„ØªØµØ§Ø¯Ù…
        <select id="collisionMode" style="width:100px">
          <option value="none">Ø¨Ø¯ÙˆÙ†</option>
          <option value="merge">Ø¯Ù…Ø¬</option>
        </select>
      </label>
      <div class="row" style="margin-top:6px">
        <button id="btnWarmup">ğŸ”¥ ØªØ³Ø®ÙŠÙ† (200)</button>
      </div>
    </div>

    <div class="group">
      <h4>ÙƒØ§Ù…ÙŠØ±Ø§ 3D</h4>
      <label>ØªÙƒØ¨ÙŠØ± <input id="zoomRange" type="range" min="-200" max="200" step="2" value="0" /></label>
      <label>Ø¯ÙˆØ±Ø§Ù† Ø£ÙÙ‚ÙŠ <input id="rotY" type="range" min="0" max="360" step="2" value="45" /></label>
      <label>Ø¯ÙˆØ±Ø§Ù† Ø¹Ù…ÙˆØ¯ÙŠ <input id="rotX" type="range" min="-90" max="90" step="2" value="30" /></label>
      <small class="muted" id="zoomLabel">â€”</small>
    </div>

    <div class="group">
      <h3>Ù…Ø´Ø§Ù‡Ø¯ Ø¬Ø§Ù‡Ø²Ø©</h3>
      <select id="preset" style="width:100%">
        <option value="solar">Ù†Ø¸Ø§Ù… Ø´Ù…Ø³ÙŠ</option>
        <option value="binary">Ù†Ø¬Ù…Ø§Ù† Ø«Ù†Ø§Ø¦ÙŠØ§Ù†</option>
        <option value="three">Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø«Ù„Ø§Ø«Ø©</option>
        <option value="bhStar">Ø«Ù‚Ø¨ Ø£Ø³ÙˆØ¯</option>
        <option value="random">Ø¹Ø´ÙˆØ§Ø¦ÙŠ</option>
      </select>
      <button id="btnLoadPreset" style="width:100%;margin-top:6px">ØªØ­Ù…ÙŠÙ„</button>
    </div>

    <div class="group">
      <h3>Ø¥Ø¶Ø§ÙØ© Ø¬Ø±Ù…</h3>
      <label>Ø§Ø³Ù… <input id="bName" value="Body" style="width:100px"/></label>
      <label>ÙƒØªÙ„Ø© <input id="bMass" type="number" value="5.972e24" style="width:100px"/></label>
      <label>x <input id="bX" type="number" value="1.5e11" style="width:100px"/></label>
      <label>y <input id="bY" type="number" value="0" style="width:100px"/></label>
      <label>z <input id="bZ" type="number" value="0" style="width:100px"/></label>
      <label>vx <input id="bVX" type="number" value="0" style="width:100px"/></label>
      <label>vy <input id="bVY" type="number" value="29780" style="width:100px"/></label>
      <label>vz <input id="bVZ" type="number" value="0" style="width:100px"/></label>
      <div class="row" style="margin-top:6px">
        <button id="btnAdd">â• Ø¥Ø¶Ø§ÙØ©</button>
        <button id="btnClear">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ÙƒÙ„</button>
      </div>
    </div>

    <div class="group">
      <h3>Ø®ÙŠØ§Ø±Ø§Øª</h3>
      <label><input type="checkbox" id="showTrails" checked /> Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª</label>
      <label><input type="checkbox" id="showGrid" checked /> Ø§Ù„Ø´Ø¨ÙƒØ©</label>
      <!-- Ø¨Ø¹Ø¯ Ø³Ø·Ø± <label><input type="checkbox" id="showGrid" checked /> Ø§Ù„Ø´Ø¨ÙƒØ©</label> -->
<label><input type="checkbox" id="showDistChart" /> Ø±Ø³Ù… Ø§Ù„Ù…Ø³Ø§ÙØ§Øª</label>
      <label>ØªØªØ¨Ø¹ <select id="track" style="width:100px"></select></label>
      <button id="btnTrackRecalc" style="width:100%;margin-top:4px">ğŸ¯ ØªØªØ¨Ø¹ + Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ 40Ø«</button>
      <label>ÙˆØ¶Ø¹ Ø§Ù„ØªØªØ¨Ø¹
  <select id="trackMode" style="width:120px">
    <option value="free">Ø­Ø±</option>
    <option value="body">Ø¬Ø³Ù…</option>
    <option value="group">Ù…Ø¬Ù…ÙˆØ¹Ø©</option>
    <option value="cm">Ø§Ù„Ù…Ø±Ø¬Ø­ (CM)</option>
  </select>
</label>
<small style="opacity:.8">ÙÙŠ ÙˆØ¶Ø¹ â€œÙ…Ø¬Ù…ÙˆØ¹Ø©â€ Ø§Ø®ØªØ± Ø§Ù„Ø£Ø¬Ø³Ø§Ù… Ù…Ù† Ø¨Ø·Ø§Ù‚Ø§ØªÙ‡Ø§ (Ø²Ø± ğŸ¯)</small>

      <button id="btnCSV" style="width:100%;margin-top:4px">ğŸ’¾ Ø­ÙØ¸ CSV</button>
      <label><input type="checkbox" id="autoReorbit" checked /> Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ ÙƒÙ„ 30Ø«</label>
      <button id="btnReorbit" style="width:100%">â†» Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¢Ù†</button>
      <label><input type="checkbox" id="anchorHeavy" checked /> ØªØ«Ø¨ÙŠØª Ø§Ù„Ø£Ø«Ù‚Ù„ ÙƒÙ…Ø±Ø¬Ø¹</label>
      <button id="btnBary" style="width:100%;margin-top:4px">â†” Ø¥Ø·Ø§Ø± Ø¨Ø§Ø±ÙŠ-Ù…Ø±ÙƒØ²ÙŠ (Ø·Ø±Ø­ CM)</button>
      <button id="btnAnchorHeavy" style="width:100%;margin-top:4px">ğŸ¯ ØªØ«Ø¨ÙŠØª Ø§Ù„Ø£ØµÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø£Ø«Ù‚Ù„</button>
      <button id="btnRetune" style="width:100%;margin-top:4px">âš™ï¸ Ø³Ø±Ø¹Ø§Øª Ø¯Ø§Ø¦Ø±ÙŠØ© Ø­ÙˆÙ„ Ø§Ù„Ø£Ø«Ù‚Ù„</button>

    </div>

    <div class="group">
      <h3>Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø£Ø¬Ø³Ø§Ù…</h3>
      <div id="bodyCards" class="cards"></div>
    </div>
  </aside>
</div>
<script src="app.js"></script>
</body>


